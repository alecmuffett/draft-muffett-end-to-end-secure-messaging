*** text/draft-muffett-end-to-end-secure-messaging-01.txt	2021-05-24 14:05:16.000000000 +0100
--- text/draft-muffett-end-to-end-secure-messaging-02.txt	2021-06-14 20:37:36.000000000 +0100
***************
*** 4,19 ****
  
  individual submission                                         A. Muffett
  Internet-Draft                                       Security Researcher
! Intended status: Informational                               24 May 2021
! Expires: 25 November 2021
  
  
            Functional Definition of End-to-End Secure Messaging
!               draft-muffett-end-to-end-secure-messaging-01
  
  Abstract
  
!    This document defines End-to-End Secure Messaging in terms of the
     behaviours that MUST be exhibited by software that claims to
     implement it, or which claims to implement that subset which is known
     as End-to-End Encrypted Messaging.
--- 4,19 ----
  
  individual submission                                         A. Muffett
  Internet-Draft                                       Security Researcher
! Intended status: Informational                              14 June 2021
! Expires: 16 December 2021
  
  
            Functional Definition of End-to-End Secure Messaging
!               draft-muffett-end-to-end-secure-messaging-02
  
  Abstract
  
!    This document defines End-to-End Secure Messaging in terms of
     behaviours that MUST be exhibited by software that claims to
     implement it, or which claims to implement that subset which is known
     as End-to-End Encrypted Messaging.
***************
*** 33,39 ****
     time.  It is inappropriate to use Internet-Drafts as reference
     material or to cite them other than as "work in progress."
  
!    This Internet-Draft will expire on 25 November 2021.
  
  Copyright Notice
  
--- 33,39 ----
     time.  It is inappropriate to use Internet-Drafts as reference
     material or to cite them other than as "work in progress."
  
!    This Internet-Draft will expire on 16 December 2021.
  
  Copyright Notice
  
***************
*** 53,61 ****
  
  
  
! Muffett                 Expires 25 November 2021                [Page 1]
  
! Internet-Draft                    e2esm                         May 2021
  
  
  Table of Contents
--- 53,61 ----
  
  
  
! Muffett                 Expires 16 December 2021                [Page 1]
  
! Internet-Draft                    e2esm                        June 2021
  
  
  Table of Contents
***************
*** 77,89 ****
       3.6.  Conversation, Group, De-/Centralised  . . . . . . . . . .   6
       3.7.  Backdoor  . . . . . . . . . . . . . . . . . . . . . . . .   6
     4.  Principles  . . . . . . . . . . . . . . . . . . . . . . . . .   6
!      4.1.  Transparency of Participation . . . . . . . . . . . . . .   6
       4.2.  Integrity of Participation  . . . . . . . . . . . . . . .   7
         4.2.1.  Retransmission Exception  . . . . . . . . . . . . . .   7
       4.3.  Equality of Participation . . . . . . . . . . . . . . . .   7
       4.4.  Closure of Conversation . . . . . . . . . . . . . . . . .   7
         4.4.1.  Public Conversations and Self-Subscription  . . . . .   7
!      4.5.  Management of Participant Clients and Devices . . . . . .   7
     5.  Rationales  . . . . . . . . . . . . . . . . . . . . . . . . .   8
       5.1.  Why: Content PCASM  . . . . . . . . . . . . . . . . . . .   8
       5.2.  Why: Size PCASM . . . . . . . . . . . . . . . . . . . . .   8
--- 77,89 ----
       3.6.  Conversation, Group, De-/Centralised  . . . . . . . . . .   6
       3.7.  Backdoor  . . . . . . . . . . . . . . . . . . . . . . . .   6
     4.  Principles  . . . . . . . . . . . . . . . . . . . . . . . . .   6
!      4.1.  Transparency of Participation . . . . . . . . . . . . . .   7
       4.2.  Integrity of Participation  . . . . . . . . . . . . . . .   7
         4.2.1.  Retransmission Exception  . . . . . . . . . . . . . .   7
       4.3.  Equality of Participation . . . . . . . . . . . . . . . .   7
       4.4.  Closure of Conversation . . . . . . . . . . . . . . . . .   7
         4.4.1.  Public Conversations and Self-Subscription  . . . . .   7
!      4.5.  Management of Participant Clients and Devices . . . . . .   8
     5.  Rationales  . . . . . . . . . . . . . . . . . . . . . . . . .   8
       5.1.  Why: Content PCASM  . . . . . . . . . . . . . . . . . . .   8
       5.2.  Why: Size PCASM . . . . . . . . . . . . . . . . . . . . .   8
***************
*** 109,117 ****
  
  
  
! Muffett                 Expires 25 November 2021                [Page 2]
  
! Internet-Draft                    e2esm                         May 2021
  
  
     9.  See Also  . . . . . . . . . . . . . . . . . . . . . . . . . .  15
--- 109,117 ----
  
  
  
! Muffett                 Expires 16 December 2021                [Page 2]
  
! Internet-Draft                    e2esm                        June 2021
  
  
     9.  See Also  . . . . . . . . . . . . . . . . . . . . . . . . . .  15
***************
*** 126,133 ****
     End-to-End Secure Messaging (E2ESM) is a mechanism which offers a
     digital analogue of "closed distribution lists" for sharing message
     content amongst a set of participants, where all participants are
!    visible to each other and where non-participants are excluded from
!    access to message content.
  
     In client-server network models it is common to implement E2ESM by
     means of encryption, in order to obscure content at rest upon a
--- 126,133 ----
     End-to-End Secure Messaging (E2ESM) is a mechanism which offers a
     digital analogue of "closed distribution lists" for sharing message
     content amongst a set of participants, where all participants are
!    visible to each other and where non-participants are completely
!    excluded from access to message content.
  
     In client-server network models it is common to implement E2ESM by
     means of encryption, in order to obscure content at rest upon a
***************
*** 140,147 ****
     content to relevant participants.
  
     Therefore we describe E2ESM in terms of functional behaviours of the
!    software rather than in terms of its implementation goals and
!    technologies.
  
  1.1.  Comments
  
--- 140,147 ----
     content to relevant participants.
  
     Therefore we describe E2ESM in terms of functional behaviours of the
!    software rather than in terms of its implementation technologies and
!    architecture.
  
  1.1.  Comments
  
***************
*** 165,173 ****
  
  
  
! Muffett                 Expires 25 November 2021                [Page 3]
  
! Internet-Draft                    e2esm                         May 2021
  
  
  2.  Requirements for an End-to-End Secure Messenger
--- 165,173 ----
  
  
  
! Muffett                 Expires 16 December 2021                [Page 3]
  
! Internet-Draft                    e2esm                        June 2021
  
  
  2.  Requirements for an End-to-End Secure Messenger
***************
*** 175,183 ****
     Software which functions as an End-to-End Secure Messenger MUST
     satisfy the following principles, and MUST satisfy these principles
     in respect of the provided definitions for all forms of communication
!    and data-sharing that the software offers.  The software MAY comprise
!    either a complete application, or a clearly defined subset of
!    functionality within a larger application.
  
     Any software that does not satisfy these requirements is not an End-
     to-End Secure Messenger, and it does not implement End-to-End Secure
--- 175,183 ----
     Software which functions as an End-to-End Secure Messenger MUST
     satisfy the following principles, and MUST satisfy these principles
     in respect of the provided definitions for all forms of communication
!    and data-sharing that the software offers.  The E2ESM software MAY
!    comprise either a complete application, or a clearly defined subset
!    of functionality within a larger application.
  
     Any software that does not satisfy these requirements is not an End-
     to-End Secure Messenger, and it does not implement End-to-End Secure
***************
*** 195,201 ****
  
     3.  Ricochet Messenger
  
!    4.  PGP-Encrypted Email (in limited circumstances)
  
     Further context for several of these definitions can also be found in
     the rationales section, below.
--- 195,202 ----
  
     3.  Ricochet Messenger
  
!    4.  PGP-Encrypted Email sent to an ad-hoc list of addressees, or to a
!        maillist
  
     Further context for several of these definitions can also be found in
     the rationales section, below.
***************
*** 220,229 ****
  
  
  
  
! Muffett                 Expires 25 November 2021                [Page 4]
! 
! Internet-Draft                    e2esm                         May 2021
  
  
  3.2.1.  Content PCASM
--- 221,229 ----
  
  
  
+ Muffett                 Expires 16 December 2021                [Page 4]
  
! Internet-Draft                    e2esm                        June 2021
  
  
  3.2.1.  Content PCASM
***************
*** 231,247 ****
     Content PCASM is any data that can offer better than 50-50 certainty
     regarding the value of any bit of the content.
  
  3.2.2.  Size PCASM
  
     For block encryption of content, Size PCASM is the unpadded size of
     the content.
  
     For stream encryption of content, Size PCASM is currently undefined
!    (TBD)
  
     For transport encryption of content, exact Size PCASM SHOULD NOT be
     observable or inferable.
  
  3.2.3.  Analytic PCASM
  
     Analytic PCASM is data which analyses, describes, reduces, or
--- 231,251 ----
     Content PCASM is any data that can offer better than 50-50 certainty
     regarding the value of any bit of the content.
  
+    TODO: where to reference [CipherInd]?
+ 
  3.2.2.  Size PCASM
  
     For block encryption of content, Size PCASM is the unpadded size of
     the content.
  
     For stream encryption of content, Size PCASM is currently undefined
!    (TODO, would benefit from broader input)
  
     For transport encryption of content, exact Size PCASM SHOULD NOT be
     observable or inferable.
  
+    TODO: where to reference issues from [BREACH]?
+ 
  3.2.3.  Analytic PCASM
  
     Analytic PCASM is data which analyses, describes, reduces, or
***************
*** 271,286 ****
     A "recipient" is an entity which receives messages and MAY be able to
     access the PCASM of those messages.
  
-    For each message there will be one sender and one or more recipients.
- 
- 
  
  
  
! Muffett                 Expires 25 November 2021                [Page 5]
  
- Internet-Draft                    e2esm                         May 2021
  
  
  3.5.  Participants and Non-Participants
  
--- 275,288 ----
     A "recipient" is an entity which receives messages and MAY be able to
     access the PCASM of those messages.
  
  
  
+ Muffett                 Expires 16 December 2021                [Page 5]
  
! Internet-Draft                    e2esm                        June 2021
  
  
+    For each message there will be one sender and one or more recipients.
  
  3.5.  Participants and Non-Participants
  
***************
*** 313,321 ****
  3.7.  Backdoor
  
     A "backdoor" is any intentional or unintentional mechanism, in
!    respect of a given message and that message's set of participants,
!    where some PCASM of that message MAY become available to a non-
!    participant without the intentional action of a participant.
  
  4.  Principles
  
--- 315,323 ----
  3.7.  Backdoor
  
     A "backdoor" is any intentional or unintentional mechanism, in
!    respect of a given message and that message's participants, where
!    some PCASM of that message MAY become available to a non-participant
!    without the intentional action of a participant.
  
  4.  Principles
  
***************
*** 324,342 ****
     constitute a "conversation" amongst a set of "participants", to
     provide E2ESM will require:
  
- 4.1.  Transparency of Participation
  
-    In the nature of "closed distribution lists", the participants in a
-    message MUST be frozen into an immutable set at the moment when the
-    message is composed or sent.
  
  
  
  
- Muffett                 Expires 25 November 2021                [Page 6]
  
- Internet-Draft                    e2esm                         May 2021
  
  
     The complete set of all recipients MUST be visible to the sender at
     the moment of message composition or sending.
--- 326,348 ----
     constitute a "conversation" amongst a set of "participants", to
     provide E2ESM will require:
  
  
  
  
  
  
  
  
+ Muffett                 Expires 16 December 2021                [Page 6]
+ 
+ Internet-Draft                    e2esm                        June 2021
+ 
+ 
+ 4.1.  Transparency of Participation
+ 
+    In the nature of "closed distribution lists", the participants in a
+    message MUST be frozen into an immutable set at the moment when the
+    message is composed or sent.
  
     The complete set of all recipients MUST be visible to the sender at
     the moment of message composition or sending.
***************
*** 377,398 ****
     "intentional action" to increase the set of participants in the
     group.
  
- 4.5.  Management of Participant Clients and Devices
  
-    Where there exists centralised E2ESM software that hosts
-    participants:
  
-    1.  The E2ESM software MUST provide each participant entity with
-        means to review or revoke access for clients or devices that can
-        access future PCASM.
  
  
  
  
! Muffett                 Expires 25 November 2021                [Page 7]
  
! Internet-Draft                    e2esm                         May 2021
  
  
     2.  The E2ESM software MUST provide each participant entity with
         notifications and/or complete logs of changes to the set of
--- 383,407 ----
     "intentional action" to increase the set of participants in the
     group.
  
  
  
  
  
  
  
! Muffett                 Expires 16 December 2021                [Page 7]
! 
! Internet-Draft                    e2esm                        June 2021
! 
! 
! 4.5.  Management of Participant Clients and Devices
  
!    Where there exists centralised E2ESM software that hosts
!    participants:
  
+    1.  The E2ESM software MUST provide each participant entity with
+        means to review or revoke access for clients or devices that can
+        access future PCASM.
  
     2.  The E2ESM software MUST provide each participant entity with
         notifications and/or complete logs of changes to the set of
***************
*** 422,428 ****
  
     Conversational Metadata MAY offer insight into Content PCASM, however
     the abstractions of transport mechanism, group management, or
!    platform choice, MAY render this irrelevant.
  
     For example an PGP-Encrypted email distribution list named
     "blockchain-fans@example.com" would leak its implicit topic and
--- 431,437 ----
  
     Conversational Metadata MAY offer insight into Content PCASM, however
     the abstractions of transport mechanism, group management, or
!    platform choice, MAY render this moot.
  
     For example an PGP-Encrypted email distribution list named
     "blockchain-fans@example.com" would leak its implicit topic and
***************
*** 433,438 ****
--- 442,455 ----
     The term "participant" in this document exists to supersede the more
     vague notion of "end" in the phrase "end-to-end".
  
+ 
+ 
+ 
+ Muffett                 Expires 16 December 2021                [Page 8]
+ 
+ Internet-Draft                    e2esm                        June 2021
+ 
+ 
     Entities, and thus participants, are defined in terms of their
     [TrustedComputingBase] to acknowledge that an entity MAY legitimately
     store, forward, or access messages by means that are outside of the
***************
*** 442,455 ****
     their TCB, is the foundation for all other trust in E2ESM.  This
     develops from the basic definitions of a [TrustedComputingBase] and
     from the concepts of "trust-to-trust" discussed in [RoleOfTrust].
- 
- 
- 
- Muffett                 Expires 25 November 2021                [Page 8]
- 
- Internet-Draft                    e2esm                         May 2021
- 
- 
     Failure of a participant to maintain integrity or control over their
     TCB should not be considered a failure of an E2ESM that connects it
     to other participants.
--- 459,464 ----
***************
*** 487,510 ****
     "intention or opportunity" - and for all of them an access
     facilitation mechanism is first REQUIRED.
  
-    An access facilitation mechanism is a "door", and is inherently
-    [DualUse].  Because the goal of E2ESM is to limit access to PCASM
-    exclusively to a defined set of participants, then the intended means
-    of access is clearly the "front door"; and any other access mechanism
-    is a "back door".
- 
  
  
  
  
  
  
  
  
! Muffett                 Expires 25 November 2021                [Page 9]
! 
! Internet-Draft                    e2esm                         May 2021
! 
  
     If the term "back door" is considered innately pejorative,
     alternative, uncertain constructions such as "illegitimate access
--- 496,516 ----
     "intention or opportunity" - and for all of them an access
     facilitation mechanism is first REQUIRED.
  
  
  
  
  
  
+ Muffett                 Expires 16 December 2021                [Page 9]
  
+ Internet-Draft                    e2esm                        June 2021
  
  
!    An access facilitation mechanism is a "door", and is inherently
!    [DualUse].  Because the goal of E2ESM is to limit access to PCASM
!    exclusively to a defined set of participants, then the intended means
!    of access is clearly the "front door"; and any other access mechanism
!    is a "back door".
  
     If the term "back door" is considered innately pejorative,
     alternative, uncertain constructions such as "illegitimate access
***************
*** 545,566 ****
     that PCASM will only be available to the participants ("ends") at the
     time the message was composed.
  
-    If this was not the intention we would deduce that an E2ESM would
-    automatically make past content available to newly-added conversation
-    participants, thereby breaking forward secrecy.  This is not a
-    characteristic of any E2ESM, but it is characteristic of several non-
-    E2ESM.  Therefore the converse is true.
  
  
  
  
  
  
  
! Muffett                 Expires 25 November 2021               [Page 10]
  
- Internet-Draft                    e2esm                         May 2021
  
  
  5.9.  Why: Equality of Participation
  
--- 551,572 ----
     that PCASM will only be available to the participants ("ends") at the
     time the message was composed.
  
  
  
  
  
  
  
+ Muffett                 Expires 16 December 2021               [Page 10]
  
! Internet-Draft                    e2esm                        June 2021
  
  
+    If this was not the intention we would deduce that an E2ESM would
+    automatically make past content available to newly-added conversation
+    participants, thereby breaking forward secrecy.  This is not a
+    characteristic of any E2ESM, but it is characteristic of several non-
+    E2ESM.  Therefore the converse is true.
  
  5.9.  Why: Equality of Participation
  
***************
*** 604,622 ****
     access by forcing a platform to silently add extra means of PCASM
     access to an existing participant on behalf of that non-participant.
  
-    Therefore to be an E2ESM the platform MUST provide the described
-    management of participant clients and devices.
- 
  
  
  
  
  
  
! Muffett                 Expires 25 November 2021               [Page 11]
! 
! Internet-Draft                    e2esm                         May 2021
! 
  
  6.  OPTIONAL Features of E2ESM
  
--- 610,625 ----
     access by forcing a platform to silently add extra means of PCASM
     access to an existing participant on behalf of that non-participant.
  
  
  
  
+ Muffett                 Expires 16 December 2021               [Page 11]
  
+ Internet-Draft                    e2esm                        June 2021
  
  
!    Therefore to be an E2ESM the platform MUST provide the described
!    management of participant clients and devices.
  
  6.  OPTIONAL Features of E2ESM
  
***************
*** 644,651 ****
  
     Similarly WhatsApp provides each participant with a "verifiable
     security QR code" and "security code change notifications", but these
!    codes do not "leak" the number of "WhatsApp For Web" clients which
!    are bound to that phone.
  
     Participant-client information of this kind MAY be a highly private
     aspect of that participant's TCB, and SHOULD be treated sensitively
--- 647,655 ----
  
     Similarly WhatsApp provides each participant with a "verifiable
     security QR code" and "security code change notifications", but these
!    codes do not "leak" the number of "WhatsApp For Web" connections,
!    desktop WhatsApp applications, or other clients which are bound to
!    the E2ESM software which executes on that phone.
  
     Participant-client information of this kind MAY be a highly private
     aspect of that participant's TCB, and SHOULD be treated sensitively
***************
*** 663,678 ****
  
     1.  The content is "Hello, world."
  
-    2.  The content starts with the word "Hello"
  
-    3.  The top bit of the first byte of the content, is zero
  
  
  
- Muffett                 Expires 25 November 2021               [Page 12]
  
! Internet-Draft                    e2esm                         May 2021
  
  
     4.  The MD5 hash of the content is 080aef839b95facf73ec599375e92d47
  
--- 667,682 ----
  
     1.  The content is "Hello, world."
  
  
  
+ Muffett                 Expires 16 December 2021               [Page 12]
  
+ Internet-Draft                    e2esm                        June 2021
  
  
!    2.  The content starts with the word "Hello"
  
+    3.  The top bit of the first byte of the content, is zero
  
     4.  The MD5 hash of the content is 080aef839b95facf73ec599375e92d47
  
***************
*** 718,734 ****
  
     4.  group topics
  
-    5.  group icons
  
-    6.  group participant lists
  
  
  
  
- Muffett                 Expires 25 November 2021               [Page 13]
  
! Internet-Draft                    e2esm                         May 2021
  
  
  7.5.  Non-PCASM
  
--- 722,738 ----
  
     4.  group topics
  
  
  
  
+ Muffett                 Expires 16 December 2021               [Page 13]
  
+ Internet-Draft                    e2esm                        June 2021
  
  
!    5.  group icons
  
+    6.  group participant lists
  
  7.5.  Non-PCASM
  
***************
*** 771,791 ****
     FooBook MAY retain means to eject reported abusive participants from
     a conversation.  (Decrease in Closure of Participation)
  
-    FooBook MUST NOT retain means to forcibly insert new participants
-    into a conversation.  For clarity: this specification does not
-    recognise any notion of "atomic" exchange of one participant with
-    another, treating it as an ejection, followed by an "illegitimate"
-    insertion.  (Increase in Closure of Participation)
  
  
  
  
  
- Muffett                 Expires 25 November 2021               [Page 14]
  
! Internet-Draft                    e2esm                         May 2021
  
  
     FooBook MUST enable the user to observe and manage the complete state
     of their [TrustedComputingBase] with respect to their FooBook
     messaging services.  (Management and Visibility)
--- 775,797 ----
     FooBook MAY retain means to eject reported abusive participants from
     a conversation.  (Decrease in Closure of Participation)
  
  
  
  
  
  
  
! Muffett                 Expires 16 December 2021               [Page 14]
! 
! Internet-Draft                    e2esm                        June 2021
  
  
+    FooBook MUST NOT retain means to forcibly insert new participants
+    into a conversation.  For clarity: this specification does not
+    recognise any notion of "atomic" exchange of one participant with
+    another, treating it as an ejection, followed by an "illegitimate"
+    insertion.  (Increase in Closure of Participation)
+ 
     FooBook MUST enable the user to observe and manage the complete state
     of their [TrustedComputingBase] with respect to their FooBook
     messaging services.  (Management and Visibility)
***************
*** 815,823 ****
--- 821,847 ----
  
  13.  Informative References
  
+    [BREACH]   Wikipedia, "BREACH", 2021,
+               <https://en.wikipedia.org/wiki/BREACH>.
+ 
+    [CipherInd]
+               Wikipedia, "Ciphertext indistinguishability", 2021,
+               <https://en.wikipedia.org/wiki/
+               Ciphertext_indistinguishability>.
+ 
     [DualUse]  Wikipedia, "Dual-use technology", 2021,
                <https://en.wikipedia.org/wiki/Dual-use_technology>.
  
+ 
+ 
+ 
+ 
+ 
+ Muffett                 Expires 16 December 2021               [Page 15]
+ 
+ Internet-Draft                    e2esm                        June 2021
+ 
+ 
     [I-D.knodel-e2ee-definition]
                Knodel, M., Baker, F., Kolkman, O., Celi, S., and G.
                Grover, "Definition of End-to-end Encryption", Work in
***************
*** 834,847 ****
                Domain Name", RFC 7686, DOI 10.17487/RFC7686, October
                2015, <https://www.rfc-editor.org/info/rfc7686>.
  
- 
- 
- 
- Muffett                 Expires 25 November 2021               [Page 15]
- 
- Internet-Draft                    e2esm                         May 2021
- 
- 
     [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
                2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
                May 2017, <https://www.rfc-editor.org/info/rfc8174>.
--- 858,863 ----
***************
*** 877,896 ****
  
  
  
! 
! 
! 
! 
! 
! 
! 
! 
! 
! 
! 
! 
! 
! 
! 
! 
! Muffett                 Expires 25 November 2021               [Page 16]
--- 893,896 ----
  
  
  
! Muffett                 Expires 16 December 2021               [Page 16]
